# tygrep design

From a high level, `tygrep` offers a DSL to specify type signatures that works across languages, and then executes this query on type information (generated by external tools).

## Project goals

Here are some of the goals of this project

* Reasonably fast, valid for interactive use even on larger code bases
    * Must understand type systems for different programming languages
    * Must provide an expressive enough language to query them
* Work across multiple programming languages
* Provide actionable results
    * File / Line locations
    * Link to documentation for 3rd party results

Other negotiable goals:

* This should be able to run as a CLI app and not require a long running server in the background.
* This should not require much language specific setup (i.e: a flag that enables "python" mode or "rust" mode or whatever)

## Current design

The current design includes:

- Source intelligence: [SCIP](https://github.com/sourcegraph/scip/)
- Search engine: We store the relevant information on [SQLite](https://sqlite.org/index.html) and use it for query execution.
- DSL: A custom implementation. Currently it's heavily based on Rust syntax.


### Query execution

With this in design in mind, the current would be:

1. Parse the query
2. Load the SCIP information
3. Generate a source intelligence index (functions and their types)
4. Execute the query
5. Prepare the result


### Potential improvements

Some obvious improvements on this design (pending measurement!):

* Caching SCIP information across runs
* Caching SQLite database info across runs
* Expand the querying to include other filters
    * E.g: only include class methods, or don't include anonymous functions, or search by traits / interface
